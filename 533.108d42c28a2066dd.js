"use strict";(self.webpackChunkprivate_screen_booking_app=self.webpackChunkprivate_screen_booking_app||[]).push([[533],{7533:(B,A,u)=>{u.r(A),u.d(A,{AdminModule:()=>w});var p=u(9808),c=u(1083),t=u(5e3),g=u(4244),i=u(3075),f=u(262),_=u(9646),q=u(2340),P=u(520);let h=(()=>{class n{constructor(e){this.http=e,this.apiUrl=q.N.apiURL}login(e,r){return this.http.post(this.apiUrl+"/auth/login",{username:e,password:r}).pipe((0,f.K)(this.handleError("login")))}pendingPayments(){return this.http.get(this.apiUrl+"/auth/pending-payments").pipe((0,f.K)(this.handleError("get pending payments")))}updatePendingPayment(e,r){return this.http.put(this.apiUrl+"/auth/pending-payment-status ",{orderId:e,paymentStatus:r}).pipe((0,f.K)(this.handleError("update pending payment")))}handleError(e="operation",r){return o=>(console.error(`${e} failed: ${o.message}`),(0,_.of)(r))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(P.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var m=u(9224),s=u(7322),v=u(7531),C=u(5245),Z=u(7423);function b(n,a){1&n&&(t.TgZ(0,"div",10),t._uU(1,"Invalid username or password."),t.qZA())}function I(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"UserName is required"),t.qZA())}function O(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Please enter valid User Name"),t.qZA())}function S(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Please enter more than 8 character "),t.qZA())}let T=(()=>{class n{constructor(e,r,o,d){this.router=e,this.jwtHelper=r,this.adminService=o,this.fb=d,this.flag=!0,this.login=l=>{this.adminService.login(l.value.username,l.value.password).subscribe(U=>{const j=U.userId;localStorage.setItem("access_token",U.token),localStorage.setItem("userId",j),this.invalidLogin=!1,this.router.navigate(["/admin"])})}}ngOnInit(){this.loginForm=this.fb.group({username:[null,[i.kI.required]],password:[null,[i.kI.required]]})}isUserAuthenticated(){const e=localStorage.getItem("access_token");return!(!e||this.jwtHelper.isTokenExpired(e))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.F0),t.Y36(g.N0),t.Y36(h),t.Y36(i.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-login"]],decls:35,vars:8,consts:[[1,"login-card"],["class","alert alert-danger",4,"ngIf"],["autocomplete","off",3,"formGroup","ngSubmit"],["appearance","legacy"],["matInput","","formControlName","username","placeholder","Your userName"],[4,"ngIf"],["appearance","standard"],["matInput","","placeholder","Enter your password","formControlName","password",3,"type"],["matSuffix","",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"alert","alert-danger"]],template:function(e,r){if(1&e&&(t.TgZ(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3,"Login"),t.qZA()(),t.TgZ(4,"mat-card-content")(5,"mat-card")(6,"mat-card-title"),t._uU(7,"Login"),t.qZA(),t.TgZ(8,"mat-card-content"),t.YNc(9,b,2,0,"div",1),t.TgZ(10,"form",2),t.NdJ("ngSubmit",function(){return r.login(r.loginForm)}),t.TgZ(11,"div")(12,"mat-form-field",3)(13,"mat-label"),t._uU(14,"User Name:"),t.qZA(),t._UZ(15,"input",4),t.TgZ(16,"mat-hint"),t._uU(17,"Enter your username "),t.qZA(),t.YNc(18,I,2,0,"mat-error",5),t.YNc(19,O,2,0,"mat-error",5),t.qZA()(),t.TgZ(20,"div")(21,"mat-form-field",6)(22,"mat-label"),t._uU(23,"Password "),t.qZA(),t._UZ(24,"input",7),t.TgZ(25,"mat-icon",8),t.NdJ("click",function(){return r.flag=!r.flag}),t._uU(26),t.qZA(),t.TgZ(27,"mat-error"),t._uU(28,"Password is required"),t.qZA(),t.YNc(29,S,2,0,"mat-error",5),t.qZA(),t._UZ(30,"br")(31,"br"),t.qZA(),t.TgZ(32,"div")(33,"button",9),t._uU(34,"Login"),t.qZA()()()()()()()),2&e){let o,d,l;t.xp6(9),t.Q6J("ngIf",r.invalidLogin),t.xp6(1),t.Q6J("formGroup",r.loginForm),t.xp6(8),t.Q6J("ngIf",null==(o=r.loginForm.get("username"))||null==o.errors?null:o.errors.required),t.xp6(1),t.Q6J("ngIf",null==(d=r.loginForm.get("username"))||null==d.errors?null:d.errors.pattern),t.xp6(5),t.Q6J("type",r.flag?"password":"text"),t.xp6(2),t.Oqu(r.flag?"visibility":"visibility_off"),t.xp6(3),t.Q6J("ngIf",null==(l=r.loginForm.get("password"))||null==l.errors?null:l.errors.pattern),t.xp6(4),t.Q6J("disabled",!r.loginForm.valid)}},directives:[m.a8,m.dk,m.n5,m.dn,p.O5,i._Y,i.JL,i.sg,s.KE,s.hX,v.Nt,i.Fj,i.JJ,i.u,s.bx,s.TO,C.Hw,s.R9,Z.lW],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.top-padding[_ngcontent-%COMP%]{padding-top:3px}.margin-left[_ngcontent-%COMP%]   mat-radio-button[_ngcontent-%COMP%]:not(:first-child){margin-left:10px}.form-container[_ngcontent-%COMP%]{margin:100px}"]}),n})();function F(n,a){if(1&n&&(t.TgZ(0,"tbody")(1,"tr")(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.qZA()()()),2&n){const e=a.$implicit;t.xp6(3),t.Oqu(e._id),t.xp6(2),t.Oqu(e.email),t.xp6(2),t.Oqu(e.fullName),t.xp6(2),t.Oqu(e.numberOfSeats),t.xp6(2),t.Oqu(e.paymentStatus),t.xp6(2),t.Oqu(e.phoneNumber),t.xp6(2),t.Oqu(e.price),t.xp6(2),t.Oqu(e.screenDate),t.xp6(2),t.Oqu(e.theatreName),t.xp6(2),t.Oqu(e.screenFromTime),t.xp6(2),t.Oqu(e.screenToTime)}}let N=(()=>{class n{constructor(e){this.adminService=e,this.pendingPaymentOrders=[]}ngOnInit(){this.adminService.pendingPayments().subscribe(e=>{this.pendingPaymentOrders=e.pendingPaymentsOrder,console.log(this.pendingPaymentOrders)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-get-pending-payment"]],decls:28,vars:1,consts:[[1,"h4"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t._uU(1,"All Pending Payment Orders "),t.qZA(),t.TgZ(2,"table",1)(3,"thead")(4,"tr")(5,"th"),t._uU(6,"Order Id"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"email"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"fullName "),t.qZA(),t.TgZ(11,"th"),t._uU(12,"numberOfSeats "),t.qZA(),t.TgZ(13,"th"),t._uU(14,"paymentStatus"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"phoneNumber "),t.qZA(),t.TgZ(17,"th"),t._uU(18,"price"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"screenDate "),t.qZA(),t.TgZ(21,"th"),t._uU(22,"theatreName "),t.qZA(),t.TgZ(23,"th"),t._uU(24,"screenFromTime"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"screenTOTIme"),t.qZA()()(),t.YNc(27,F,24,11,"tbody",2),t.qZA()),2&e&&(t.xp6(27),t.Q6J("ngForOf",r.pendingPaymentOrders))},directives:[p.sg],styles:[""]}),n})();var x=u(7261),y=u(9814);function J(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"OrderID is required"),t.qZA())}let k=(()=>{class n{constructor(e,r,o){this.fb=e,this.adminService=r,this.snackBar=o,this.payStatus=!1,this.seasons=[!0,!1]}ngOnInit(){this.payupdateForm=this.fb.group({orderId:["",[i.kI.required]]})}update(e){this.adminService.updatePendingPayment(e.value.orderId,this.payStatus).subscribe(r=>{console.log(r),r&&(this.openSnackBar(),this.payupdateForm.reset(""))})}openSnackBar(){this.snackBar.open("Updated Success","x",{duration:5e3,panelClass:"success-snackbar"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(i.qu),t.Y36(h),t.Y36(x.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-update-pending-payment"]],decls:32,vars:6,consts:[[1,"container"],[1,"h4"],[1,"login-card"],["name","payStatus",3,"ngModel","ngModelChange"],[3,"value"],["checked","",3,"value"],["autocomplete","off",3,"formGroup","ngSubmit"],["appearance","standard"],["matInput","","formControlName","orderId","placeholder","Order Id"],[4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"Update the Pending payment"),t.qZA(),t.TgZ(3,"div")(4,"mat-card",2)(5,"mat-card-content")(6,"mat-card")(7,"mat-card-title"),t._uU(8,"Payment update form"),t.qZA(),t.TgZ(9,"mat-card-content")(10,"div")(11,"mat-label"),t._uU(12,"Payment Status"),t.qZA(),t.TgZ(13,"mat-radio-group",3),t.NdJ("ngModelChange",function(d){return r.payStatus=d}),t.TgZ(14,"mat-radio-button",4),t._uU(15," True "),t.qZA(),t.TgZ(16,"mat-radio-button",5),t._uU(17," False "),t.qZA()(),t._UZ(18,"br")(19,"br"),t.qZA(),t.TgZ(20,"form",6),t.NdJ("ngSubmit",function(){return r.update(r.payupdateForm)}),t.TgZ(21,"div")(22,"mat-form-field",7)(23,"mat-label"),t._uU(24,"Order ID "),t.qZA(),t._UZ(25,"input",8),t.TgZ(26,"mat-hint"),t._uU(27,"Enter Order Id "),t.qZA(),t.YNc(28,J,2,0,"mat-error",9),t.qZA()(),t.TgZ(29,"div")(30,"button",10),t._uU(31,"Submit"),t.qZA()()()()()()()()()),2&e){let o;t.xp6(13),t.Q6J("ngModel",r.payStatus),t.xp6(1),t.Q6J("value",!0),t.xp6(2),t.Q6J("value",!1),t.xp6(4),t.Q6J("formGroup",r.payupdateForm),t.xp6(8),t.Q6J("ngIf",null==(o=r.payupdateForm.get("orderId"))||null==o.errors?null:o.errors.required),t.xp6(2),t.Q6J("disabled",!r.payupdateForm.valid)}},directives:[m.a8,m.dn,m.n5,s.hX,y.VQ,i.JJ,i.On,y.U0,i._Y,i.JL,i.sg,s.KE,v.Nt,i.Fj,i.u,s.bx,p.O5,s.TO,Z.lW],styles:[""]}),n})();function Y(n,a){1&n&&(t.TgZ(0,"div"),t._UZ(1,"app-login"),t.qZA())}function L(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"h2"),t._uU(2," Welcome to the Private-Screen-Booking Application "),t.qZA(),t.TgZ(3,"button",1),t.NdJ("click",function(){return t.CHM(e),t.oxw().logout()}),t._uU(4,"Logout"),t.qZA(),t.TgZ(5,"div",2)(6,"div",3)(7,"div",4),t._UZ(8,"app-get-pending-payment"),t.qZA(),t.TgZ(9,"div",4),t._UZ(10,"app-update-pending-payment"),t.qZA()()()()}}const M=[{path:"",component:(()=>{class n{constructor(e,r){this.jwtHelper=e,this.router=r,this.logout=()=>{localStorage.clear()}}ngOnInit(){}isUserAuthenticated(){const e=localStorage.getItem("access_token");return!(!e||this.jwtHelper.isTokenExpired(e))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.N0),t.Y36(c.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-admin"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-button","",3,"click"],[1,"container-fluid"],[1,"row"],[1,"col-sm-12"]],template:function(e,r){1&e&&(t.YNc(0,Y,2,0,"div",0),t.YNc(1,L,11,0,"div",0)),2&e&&(t.Q6J("ngIf",!r.isUserAuthenticated()),t.xp6(1),t.Q6J("ngIf",r.isUserAuthenticated()))},directives:[p.O5,T,Z.lW,N,k],styles:[""]}),n})(),canActivate:[(()=>{class n{constructor(e,r){this.jwtHelper=e,this.router=r}canActivate(e,r){const o=localStorage.getItem("access_token");return o?"ADMIN"===this.jwtHelper.decodeToken(o).role:!(!o||this.jwtHelper.isTokenExpired(o))||(this.router.navigate(["admin/login"]),!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(g.N0),t.LFG(c.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()]},{path:"login",component:T}];let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.Bz.forChild(M)],c.Bz]}),n})();var G=u(7341);let w=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,Q,G.h,i.UX,i.u5]]}),n})()}}]);